(function(c){var w=c.Array.merge(["click","dblclick","mouseover","mouseout","contextmenu"],c.Support.touch?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"]),z=/^SOLID$/i,C=/^#[0-9A-F]{6}$/i,E=/^(DOT|DASH|SOLID|DASHDOT)$/i,B=function(k){return(k||"")+c.Util.padded((this%16777215).toString(16),6,0,function(c){return c+this})},u=function(k){return function(){return!c.Array.each(k,function(c,d){d in this&&c.call(this)},this)}}({thick:function(){c.Match.isInt(this.thick)||(this.thick=
1)},alpha:function(){c.Match.isInt(this.alpha,!0)||(c.Match.isJsn(this.alpha)?(c.Match.isInt(this.alpha.ctur,!0)||(this.alpha.ctur=100),c.Match.isInt(this.alpha.fill,!0)||(this.alpha.fill=100)):this.alpha=100)},slope:function(){c.Match.isNumber(this.slope)||(this.slope=!1)},matte:function(){c.Match.isBoolean(this.matte)||(this.matte=!1)},arrow:function(){c.Match.isBoolean(this.arrow)||(this.arrow=!1)},style:function(){this.style=E.test(this.style)?this.style.toUpperCase():"SOLID"},color:function(){this.color=
C.test(this.color)?this.color.toUpperCase():"#FF0000"},stuff:function(){this.stuff=C.test(this.stuff)?this.stuff.toUpperCase():!0===this.stuff?this.color:!1},angle:function(){c.Match.isNumber((this.angle||0).f)&&c.Match.isNumber((this.angle||0).t)||(this.angle=null)},extra:function(){c.Match.isNumber((this.extra||0).x)&&c.Match.isNumber((this.extra||0).y)||(this.extra=null)},point:function(){c.Match.isNumber((this.point||0).x)&&c.Match.isNumber((this.point||0).y)||(this.point=null)}}),q={rgb2hex:function(c,
g,d){return(16777216+(c<<16)+(g<<8)+d).toString(16).slice(1)},pos2len:function(c,g,d,e){return Math.sqrt((c=d-c)*c+(g=e-g)*g)},pos4arc:function(c,g,d,e,r,t){d*=Math.cos(r);e*=Math.sin(r);r=Math.cos(t);t=Math.sin(t);return[c+(d*r-e*t),g+(d*t+e*r)]},pos4crv:function(k,g,d,e,r,t,q,f,l){var b,h=(b=c.Match.isDefined(l))?l*l:q*q;return b?[q*(b=h*l)+3*r*(h-b)+3*d*(l-2*h+b)+k*(1-3*l+3*h-b),f*b+3*t*(h-b)+3*e*(l-2*h+b)+g*(1-3*l+3*h-b)]:[r*h+d*(2*q-2*h)+k*(1-2*q+h),t*h+e*(2*q-2*h)+g*(1-2*q+h)]},ang2ecc:function(c,
g,d){return Math.atan2(g*Math.sin(c*Math.PI/180),d*Math.cos(c*Math.PI/180))},trans2d:function(){this.prototype={offset:function(k){return k?[c.Math.fix(this.m[4],10),c.Math.fix(this.m[5],10)]:[this.m[4],this.m[5]]},matrix:function(k){return k?[c.Math.fix(this.m[0],10),c.Math.fix(this.m[2],10),c.Math.fix(this.m[1],10),c.Math.fix(this.m[3],10),0,0]:this.m},matmul:function(c,g,d){this.m[5]=this.m[1]*c[4]+(g=this.m[3])*c[5]+this.m[5];this.m[4]=this.m[0]*c[4]+(d=this.m[2])*c[5]+this.m[4];this.m[3]=this.m[1]*
c[2]+g*c[3];this.m[2]=this.m[0]*c[2]+d*c[3];this.m[1]=this.m[1]*c[0]+g*c[1];this.m[0]=this.m[0]*c[0]+d*c[1];return this},rotate:function(k,g,d){var e=Math.cos(k);k=Math.sin(k);c.Match.isNumber(g)&&c.Match.isNumber(d)?(this.matmul.call(this,[e,k,-k,e,g,d]),this.matmul.call(this,[1,0,0,1,-g,-d])):(this.m[0]=(g=this.m[0])*e+this.m[2]*k,this.m[1]=(d=this.m[1])*e+this.m[3]*k,this.m[2]=g*-k+this.m[2]*e,this.m[3]=d*-k+this.m[3]*e);return this}};return this}.call(function(){this.m=[1,0,0,1,0,0]})},D=c.Support.graphic.svg?
function(k,g){k.prototype={A:function(d){for(var e=0,g=d.length;e<g;e+=7)c.Array.push(this.save,"A",d[e],d[e+1],d[e+2],d[e+3],d[e+4],d[e+5],d[e+6]);return this},C:function(d){for(var e=0,g=d.length;e<g;e+=6)c.Array.push(this.save,"C",d[e],d[e+1],d[e+2],d[e+3],d[e+4],d[e+5]);return this},Q:function(d){for(var e=0,g=d.length;e<g;e+=4)c.Array.push(this.save,"Q",d[e],d[e+1],d[e+2],d[e+3]);return this},L:function(d){for(var e=0,g=d.length;e<g;e+=2)c.Array.push(this.save,"L",d[e],d[e+1]);return this},M:function(d){for(var e=
0,g=d.length;e<g;e+=2)c.Array.push(this.save,"M",d[e],d[e+1]);return this},Z:function(){return c.Array.push(this.save,"Z")&&this},P:function(){return c.Array.join(this.save," ")}};return function(d,e,r,t){var v=0,f,l,b={x:0,y:0,w:0,h:0},h=function(b){return function(a){return function(y){b.apply(this,arguments);a.apply(this,arguments);c.Thread.delay.call(d,function(){try{(f.shapes[y.ident=B.call(v++,"_")]=this).paint()}catch(a){y.error=a}finally{y.error||(this.regist("mouseout",function(){c.Util.setMouse(r,
r.title="")}),this.regist("mouseover",c.Util.bind(this,function(){r.title=this.title||"";c.Util.setMouse(r,this.mouse)})))}},0,this)}}}(function(b,a){this.title=a.title;this.alpha=a.alpha;this.matte=a.matte;this.mouse=a.mouse;this.front=function(){(b||0).alive&&(!b.svg2d||b.run2d?c.Thread.delay.call(d,arguments.callee):f.appendChild(b.svg2d))};this.erase=function(){if(!b.svg2d||b.run2d)c.Thread.delay.call(d,arguments.callee,0,this);else if((b||0).alive&&f.removeChild(b.svg2d)){var y=delete f.shapes[b.ident];
try{y&&"arrow"in this&&(y=!!l.removeChild(c.Array.pop(c.Fn.css.call(l,"#"+b.ident))))}catch(m){y=!1}finally{!y&&(f.shapes[b.ident]=this)?f.appendChild(b.svg2d):(a=c.Array.each(b,function(a,c){delete b[c]}),b=c.Array.each(this,function(a,c){delete this[c]},this))}}};this.regist=function(a,m){c.Match.isFunction(m)&&-1<c.Array.index(w,a=c.Parse.toTxt(a))&&function(){(b||0).alive&&(!b.svg2d||b.run2d?c.Thread.delay.call(d,arguments.callee,0,this):(m[b.ident]||(m[b.ident]={}))[a]=c.Util.addEvent({evt:a,
arg:this,obj:b.svg2d,fun:function(a){m.call(this,a,this)}},!0))}.call(this)};this.reject=function(a,m){c.Match.isFunction(m)&&-1<c.Array.index(w,a=c.Parse.toTxt(a))&&function(){(b||0).alive&&(!b.svg2d||b.run2d?c.Thread.delay.call(d,arguments.callee,0,this):c.Thread.delay.call(d,function(d){((d=m[b.ident])||0)[a]&&c.Util.delEvent(d[a])&&delete d[a]}))}.call(this)}}),p={styleTo:function(b,a){switch(b){case "SOLID":return"";case "DOT":return c.Array.join([a,3*a]," ");case "DASH":return c.Array.join([4*
a,3*a]," ");case "DASHDOT":return c.Array.join([4*a,3*a,a,3*a]," ")}}};this.refix=function(n){if(!(f||0).shapes)c.Thread.delay.call(d,arguments.callee);else if(n=n||c.Util.getElemSize(r))try{c.Util.setElemSize(f,{w:b.w=c.Parse.toInt(n.w)||0,h:b.h=c.Parse.toInt(n.h)||0})}catch(a){n=null}finally{n&&(n=this.slice(b))}};this.slice=function(n){(f||0).setAttribute&&f.setAttribute("viewBox",c.Array.join([0-(b.x=c.Parse.toInt(n.x)||0),0-(b.y=c.Parse.toInt(n.y)||0),b.w,b.h]," "))};this.ready=function(){if(!t)try{t=
!c.Fx.draw.call(d,f=r.appendChild(e.createElementNS("http://www.w3.org/2000/svg","svg")),["<defs></defs>"],function(){(f.shapes={},this.refix())||c.Fx.draw.call(d,l=f.childNodes[0],['<path id="arrow-classic" d="M5 0 0 2.5 5 5 3.5 3 3.5 2Z" stroke-linecap="round"></path>'],function(){f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")})},this)}catch(b){t=!1}return t};this.renew=function(){(f||0).shapes?c.Array.each(f.shapes,function(c){c.paint()}):c.Thread.delay.call(d,
arguments.callee)};this.clear=function(){(f||0).shapes?c.Array.each(f.shapes,function(c){c.erase()}):c.Thread.delay.call(d,arguments.callee)};this.build={LINE:h(function(b,a){this.route=a.route;this.thick=a.thick;this.color=a.color;this.arrow=a.arrow;this.style=a.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!l||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var a,m=(a=3<(this.route||0).length)?(new k).M(c.Array.slice(this.route,0,2)).L(c.Array.slice(this.route,
2)).P():"M 0 0";b.svg2d&&!(b.svg2d.style.display=this.matte?"none":"")?(b.svg2d.setAttribute("d",m),b.svg2d.setAttribute("stroke",this.color),b.svg2d.setAttribute("stroke-width",this.thick),b.svg2d.setAttribute("stroke-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100),b.svg2d.setAttribute("stroke-dasharray",p.styleTo(this.style,this.thick)),b.svg2d.setAttribute("marker-end",this.arrow&&a?"url(#"+b.ident+")":"")):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.line,[m,b.ident,this.color,
this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,p.styleTo(this.style,this.thick),this.matte?"none":""])],function(){(b.svg2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&c.Fx.draw.call(d,l,[c.Util.format(g.mark,[b.ident,this.color])],function(){(b.run2d=!1,!this.matte)&&this.arrow&&a&&b.svg2d.setAttribute("marker-end","url(#"+b.ident+")")},this)},this)}}}),RECT:h(function(b,a){this.point=a.point;this.extra=a.extra;this.thick=a.thick;this.color=a.color;this.stuff=a.stuff;this.slope=
a.slope;this.style=a.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!l||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var a=this.point&&this.extra?(new k).M([this.point.x-this.extra.x,this.point.y-this.extra.y]).L([this.point.x-this.extra.x,this.point.y+this.extra.y,this.point.x+this.extra.x,this.point.y+this.extra.y,this.point.x+this.extra.x,this.point.y-this.extra.y,this.point.x-this.extra.x,this.point.y-this.extra.y]).P():"M 0 0",m=!this.matte&&this.slope&&
"M 0 0"!==a?"matrix("+(new q.trans2d).rotate(-this.slope*Math.PI/180,this.point.x,this.point.y).matrix()+")":!1;b.svg2d&&!(b.svg2d.style.display=this.matte?"none":"")?(b.svg2d.setAttribute("d",a),b.svg2d.setAttribute("fill",this.stuff||"none"),b.svg2d.setAttribute("fill-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100),b.svg2d.setAttribute("stroke",this.color),b.svg2d.setAttribute("stroke-width",this.thick),b.svg2d.setAttribute("stroke-opacity",(c.Match.isNum(this.alpha)?this.alpha:
this.alpha.ctur)/100),b.svg2d.setAttribute("stroke-dasharray",p.styleTo(this.style,this.thick)),m?b.svg2d.setAttribute("transform",m):b.svg2d.removeAttribute("transform")):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.rect,[a,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,p.styleTo(this.style,this.thick),this.matte?"none":"",this.stuff||"none",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){(b.run2d=!1,b.svg2d=c.Array.pop(c.Fn.css.call(f,
"."+b.ident)))&&m&&b.svg2d.setAttribute("transform",m)})}}}),POLY:h(function(b,a){this.route=a.route;this.thick=a.thick;this.color=a.color;this.stuff=a.stuff;this.style=a.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!l||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var a=3<(this.route||0).length?(new k).M(c.Array.slice(this.route,0,2)).L(c.Array.slice(this.route,2)).Z().P():"M 0 0";b.svg2d&&!(b.svg2d.style.display=this.matte?"none":"")?(b.svg2d.setAttribute("d",
a),b.svg2d.setAttribute("fill",this.stuff||"none"),b.svg2d.setAttribute("fill-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100),b.svg2d.setAttribute("stroke",this.color),b.svg2d.setAttribute("stroke-width",this.thick),b.svg2d.setAttribute("stroke-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100),b.svg2d.setAttribute("stroke-dasharray",p.styleTo(this.style,this.thick))):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.poly,[a,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?
this.alpha:this.alpha.ctur)/100,p.styleTo(this.style,this.thick),this.matte?"none":"",this.stuff||"none",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){b.run2d=(b.svg2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&!1})}}}),OVAL:h(function(b,a){this.point=a.point;this.extra=a.extra;this.thick=a.thick;this.color=a.color;this.stuff=a.stuff;this.slope=a.slope;this.style=a.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!l||!b.ident)c.Thread.delay.call(d,arguments.callee,
0,this);else if(u.call(this)){var a=this.point&&this.extra?(new k).M([this.point.x,this.point.y-this.extra.y]).A([this.extra.x,this.extra.y,0,1,1,this.point.x,this.point.y+this.extra.y]).A([this.extra.x,this.extra.y,0,1,1,this.point.x,this.point.y-this.extra.y]).P():"M 0 0",m=!this.matte&&this.slope&&"M 0 0"!==a?"matrix("+(new q.trans2d).rotate(-this.slope*Math.PI/180,this.point.x,this.point.y).matrix()+")":!1;b.svg2d&&!(b.svg2d.style.display=this.matte?"none":"")?(b.svg2d.setAttribute("d",a),b.svg2d.setAttribute("fill",
this.stuff||"none"),b.svg2d.setAttribute("fill-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100),b.svg2d.setAttribute("stroke",this.color),b.svg2d.setAttribute("stroke-width",this.thick),b.svg2d.setAttribute("stroke-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100),b.svg2d.setAttribute("stroke-dasharray",p.styleTo(this.style,this.thick)),m?b.svg2d.setAttribute("transform",m):b.svg2d.removeAttribute("transform")):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.oval,
[a,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,p.styleTo(this.style,this.thick),this.matte?"none":"",this.stuff||"none",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){(b.run2d=!1,b.svg2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&m&&b.svg2d.setAttribute("transform",m)})}}}),ARCH:h(function(b,a){this.angle=a.angle;this.point=a.point;this.extra=a.extra;this.thick=a.thick;this.color=a.color;this.stuff=a.stuff;this.slope=a.slope;
this.style=a.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!l||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var a=this.point&&this.extra&&this.angle?(new k).M(q.pos4arc(this.point.x,this.point.y,this.extra.x,this.extra.y,-q.ang2ecc(this.angle.f,this.extra.x,this.extra.y),0)).A(c.Array.merge([this.extra.x,this.extra.y,0,180<this.angle.t-this.angle.f?1:0,0],q.pos4arc(this.point.x,this.point.y,this.extra.x,this.extra.y,-q.ang2ecc(this.angle.t,this.extra.x,
this.extra.y),0))).L([this.point.x,this.point.y]).Z().P():"M 0 0",m=!this.matte&&this.slope&&"M 0 0"!==a?"matrix("+(new q.trans2d).rotate(-this.slope*Math.PI/180,this.point.x,this.point.y).matrix()+")":!1;b.svg2d&&!(b.svg2d.style.display=this.matte?"none":"")?(b.svg2d.setAttribute("d",a),b.svg2d.setAttribute("fill",this.stuff||"none"),b.svg2d.setAttribute("fill-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100),b.svg2d.setAttribute("stroke",this.color),b.svg2d.setAttribute("stroke-width",
this.thick),b.svg2d.setAttribute("stroke-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100),b.svg2d.setAttribute("stroke-dasharray",p.styleTo(this.style,this.thick)),m?b.svg2d.setAttribute("transform",m):b.svg2d.removeAttribute("transform")):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.arch,[a,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,p.styleTo(this.style,this.thick),this.matte?"none":"",this.stuff||"none",(c.Match.isNum(this.alpha)?
this.alpha:this.alpha.fill)/100])],function(){(b.run2d=!1,b.svg2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&m&&b.svg2d.setAttribute("transform",m)})}}}),WAVE:h(function(b,a){this.route=a.route;this.thick=a.thick;this.color=a.color;this.arrow=a.arrow;this.style=a.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!l||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var a,m=(a=5<(this.route||0).length)?(new k).M(c.Array.slice(this.route,0,2))[8===this.route.length?
"C":"Q"](c.Array.slice(this.route,2)).P():"M 0 0";b.svg2d&&!(b.svg2d.style.display=this.matte?"none":"")?(b.svg2d.setAttribute("d",m),b.svg2d.setAttribute("stroke",this.color),b.svg2d.setAttribute("stroke-width",this.thick),b.svg2d.setAttribute("stroke-opacity",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100),b.svg2d.setAttribute("stroke-dasharray",p.styleTo(this.style,this.thick)),b.svg2d.setAttribute("marker-end",this.arrow&&a?"url(#"+b.ident+")":"")):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.wave,
[m,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,p.styleTo(this.style,this.thick),this.matte?"none":""])],function(){(b.svg2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&c.Fx.draw.call(d,l,[c.Util.format(g.mark,[b.ident,this.color])],function(){(b.run2d=!1,!this.matte)&&this.arrow&&a&&b.svg2d.setAttribute("marker-end","url(#"+b.ident+")")},this)},this)}}})}}}(function(){this.save=[]},{line:'<path d="$1" class="$2" stroke="$3" stroke-width="$4" stroke-opacity="$5" stroke-dasharray="$6" style="display:$7;" fill="none"></path>',
rect:'<path d="$1" class="$2" stroke="$3" stroke-width="$4" stroke-opacity="$5" stroke-dasharray="$6" style="display:$7;" fill="$8" fill-opacity="$9"></path>',poly:'<path d="$1" class="$2" stroke="$3" stroke-width="$4" stroke-opacity="$5" stroke-dasharray="$6" style="display:$7;" fill="$8" fill-opacity="$9"></path>',oval:'<path d="$1" class="$2" stroke="$3" stroke-width="$4" stroke-opacity="$5" stroke-dasharray="$6" style="display:$7;" fill="$8" fill-opacity="$9"></path>',arch:'<path d="$1" class="$2" stroke="$3" stroke-width="$4" stroke-opacity="$5" stroke-dasharray="$6" style="display:$7;" fill="$8" fill-opacity="$9"></path>',
wave:'<path d="$1" class="$2" stroke="$3" stroke-width="$4" stroke-opacity="$5" stroke-dasharray="$6" style="display:$7;" fill="none"></path>',mark:'<marker id="$1" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5"><use xlink:href="#arrow-classic" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="$2" stroke="none"></use></marker>'}):c.Support.graphic.cav?function(k,g,d,e){var r=0,t=[],v={},f={},l=0,b=0,h=g.createElement("canvas");g=function(a){return function(b){return function(m){a.apply(this,
arguments);b.apply(this,arguments);var A;if(0<r++%1E3)A=t[t.length-1];else{A=c.Util.getElemSize(d);var e={shapes:{},mirror:h.cloneNode(!1),canvas:d.appendChild(h.cloneNode(!1))};e.canvas.style.position=e.mirror.style.position="absolute";e.canvas.height=e.mirror.height=c.Parse.toInt(A.h);e.canvas.width=e.mirror.width=c.Parse.toInt(A.w);A=t[c.Array.push(t,e)-1]}if((m.scene=A)&&(m.cav2d=m.scene.canvas.getContext("2d"))&&(m.mir2d=m.scene.mirror.getContext("2d")))try{(m.scene.shapes[m.ident=B.call(r,"#")]=
this).paint(!0)}catch(f){m.error=f}}}}(function(a,b){this.title=b.title;this.alpha=b.alpha;this.matte=b.matte;this.mouse=b.mouse;this.front=function(){if((a||0).alive&&delete a.scene.shapes[a.ident])try{this.paint()}catch(b){(a.scene.shapes[a.ident]=this).paint()}finally{!a.scene.shapes[a.ident]&&(a.scene=t[t.length-1])&&(a.cav2d=a.scene.canvas.getContext("2d"))&&(a.mir2d=a.scene.mirror.getContext("2d"))&&(a.scene.shapes[a.ident]=this).paint()}};this.erase=function(){if((a||0).alive&&delete a.scene.shapes[a.ident])try{this.paint()}catch(m){(a.scene.shapes[a.ident]=
this).paint()}finally{a.scene.shapes[a.ident]||(c.Array.each(w,function(b){(v[b]||0)[a.ident]&&delete v[b][a.ident]}),b=c.Array.each(a,function(b,c){delete a[c]}),a=c.Array.each(this,function(a,b){delete this[b]},this))}};this.regist=function(b,d){(a||0).alive&&c.Match.isFunction(d)&&(b=v[c.Parse.toTxt(b)])&&c.Array.push(b[a.ident]||(b[a.ident]=[]),d)};this.reject=function(b,d){(a||0).alive&&c.Match.isFunction(d)&&(b=(v[c.Parse.toTxt(b)]||0)[a.ident])&&c.Array.remove(b,d)}});var p=function(){for(var a=
t.length-1,b=c.Util.getMouse.call(k,this),m=c.Util.getPosition(d),e=Math.round(b.x-m.x),f=Math.round(b.y-m.y);0<=a;a--)if(255===((m=(b=t[a]).mirror.getContext("2d").getImageData(e,f,1,1).data)||0)[3])return{ident:m="#"+q.rgb2hex(m[0],m[1],m[2]),shape:b.shapes[m]}},n={styleTo:{line:function(a){return function(b,c,d,e,f,h){switch(b){case "SOLID":this.lineTo(e,f);break;case "DOT":a.call(this,c,d,e,f,[h,3*h]);break;case "DASH":a.call(this,c,d,e,f,[4*h,3*h]);break;case "DASHDOT":a.call(this,c,d,e,f,[4*
h,3*h,h,3*h])}}}(function(a,b,m,d,e){for(var f=e.length,h=m-a,n=d-b,g=h>n,p,k=0,l=0,r=Math.sqrt(h*h+n*n),q=c.Array.max([c.Array.min([g?n/h:h/n,9999]),-9999]);.1<=(r-=l);)p=Math.sqrt((l=(0===(l=e[k++%f])?.001:l)>r?r:l)*l/(1+q*q)),g?(a+=0>h&&0>n?-1*p:p,b+=0>h&&0>n?q*p*-1:q*p):(a+=0>h&&0>n?q*p*-1:q*p,b+=0>h&&0>n?-1*p:p),this[k%2?"lineTo":"moveTo"](a,b);this.moveTo(m,d)}),oval:function(a){return function(b,c,d,e,f,h){switch(b){case "SOLID":this.arc(c,d,e,0,2*Math.PI,!1);break;case "DOT":a.call(this,c,
d,e,f,[h,3*h]);break;case "DASH":a.call(this,c,d,e,f,[4*h,3*h]);break;case "DASHDOT":a.call(this,c,d,e,f,[4*h,3*h,h,3*h])}}}(function(a,b,c,d,e){var f=1/Math.floor(Math.PI*(1.5*(c+d)-Math.sqrt(c*d))),h=c*c,n=d*d;d=h+n;for(var h=h-n,n=e.length,g=0,p=0,l=0,k=0;l<=Math.PI;l+=f)(p+=Math.sqrt(d-h*Math.cos(2*l))*f*.707)>=e[g]&&(0===g%2&&(this.moveTo((p=q.pos4arc(a,b,c,c,k,0))[0],p[1]),this.arc(a,b,c,k,l,!1),this.moveTo((p=q.pos4arc(a,b,c,c,k+Math.PI,0))[0],p[1]),this.arc(a,b,c,k+Math.PI,l+Math.PI,!1)),
k=l,p=0,g=(g+1)%n)}),arch:function(a){return function(b,c,d,e,f,h,g,p){if(z.test(b))this.arc(c,d,e,h,g,!1),this.lineTo(c,d),this.closePath();else{var l=q.pos4arc(c,d,e,e,h,0),k=q.pos4arc(c,d,e,e,g,0);switch(b){case "DOT":a.call(this,c,d,e,f,h,g,[p,3*p]);this.moveTo(k[0],k[1]);n.styleTo.line.call(this,b,k[0],k[1],0,0,p);this.moveTo(0,0);n.styleTo.line.call(this,b,0,0,l[0],l[1],p);break;case "DASH":a.call(this,c,d,e,f,h,g,[4*p,3*p]);this.moveTo(k[0],k[1]);n.styleTo.line.call(this,b,k[0],k[1],0,0,p);
this.moveTo(0,0);n.styleTo.line.call(this,b,0,0,l[0],l[1],p);break;case "DASHDOT":a.call(this,c,d,e,f,h,g,[4*p,3*p,p,3*p]),this.moveTo(k[0],k[1]),n.styleTo.line.call(this,b,k[0],k[1],0,0,p),this.moveTo(0,0),n.styleTo.line.call(this,b,0,0,l[0],l[1],p)}}}}(function(a,b,c,d,e,f,h){var p=1/Math.floor(Math.PI*(1.5*(c+d)-Math.sqrt(c*d))),n=c*c,g=d*d;d=n+g;for(var n=n-g,g=h.length,k=0,l=0,r=e;r<=f;r+=p)(l+=Math.sqrt(d-n*Math.cos(2*r))*p*.707)>=h[k]&&(0===k%2&&(this.moveTo((l=q.pos4arc(a,b,c,c,e,0))[0],l[1]),
this.arc(a,b,c,e,r,!1)),e=r,l=0,k=(k+1)%g)}),wave:function(a){return function(b,c,d){if(z.test(b))switch(c.length){case 8:this.bezierCurveTo(c[2],c[3],c[4],c[5],c[6],c[7]);break;case 6:this.quadraticCurveTo(c[2],c[3],c[4],c[5])}else switch(b){case "DOT":a.call(this,c,[d,3*d]);break;case "DASH":a.call(this,c,[4*d,3*d]);break;case "DASHDOT":a.call(this,c,[4*d,3*d,d,3*d])}}}(function(a,b){for(var c,d,e,f,h,n,p,g,k=8===a.length,l=1/(q.pos2len(c=a[0],d=a[1],e=a[2],f=a[3])+q.pos2len(e,f,h=a[4],n=a[5])+
(k?q.pos2len(h,n,p=a[6],g=a[7]):0)),r=[c,d],t=b.length,u=0,v=0,w=0,x;1>=w;w+=l)x=k?q.pos4crv(c,d,e,f,h,n,p,g,w):q.pos4crv(c,d,e,f,h,n,w),(v+=q.pos2len(r[0],r[1],x[0],x[1]))>=b[u]&&(u%2===(v=0)&&this.lineTo(x[0],x[1]),u=(u+1)%t,this.moveTo(x[0],x[1])),0===u%2&&this.lineTo(x[0],x[1]),r=x})},arrowTo:function(a,b,c,d){this.save();this.beginPath();this.translate(a,b);this.moveTo(0,0);this.rotate(c);this.lineTo(-2-d,-1-.5*d);this.lineTo(-1.4-.7*d,0);this.lineTo(-2-d,1+.5*d);this.closePath();this.restore()}};
this.refix=function(a){(a=a||c.Util.getElemSize(d))&&c.Array.each(t,function(b){b.canvas.width=b.mirror.width=c.Parse.toInt(a.w)||0;b.canvas.height=b.mirror.height=c.Parse.toInt(a.h)||0})};this.slice=function(a){l=c.Parse.toInt(a.x)||0;b=c.Parse.toInt(a.y)||0;this.renew()};this.ready=function(){if(!e)try{e=!c.Array.each(w,function(a){return function(b,m){2<m?c.Util.addEvent({obj:d,evt:b,fun:function(m){switch(b){case "touchstart":case "mousedown":return function(b,c){a.call(b,(f.click=!0,m))};case "touchmove":case "mousemove":return function(b,
e){if(((e=p.call(b))||0).shape){d.title=e.shape.title||"";c.Util.setMouse(d,e.shape.mouse);try{c.Array.each(m[e.ident],function(a){a.call(this,b,this)},e.shape)}catch(h){}finally{if(f.shape!==e.shape&&f.ident!==e.ident)try{a.call(b)}catch(h){}finally{(f.ident=e.ident)&&(f.shape=e.shape)&&a.call(b,v.mouseover)}}}else{c.Util.setMouse(d,d.title="");try{a.call(b)}catch(h){}finally{f.ident=f.shape=null,f.click=f.again=!1}}};case "touchend":case "mouseup":return function(b,d){try{a.call(b,m)}catch(e){}finally{if(f.click&&
1===c.Util.getKey(b))try{a.call(b,v.click)}catch(e){}finally{try{f.again&&a.call(b,v.dblclick)}catch(e){}finally{!c.Support.touch&&(f.again=!0)&&c.Thread.delay.call(k,function(){f.again=!1},300)}}}f.click=!1};case "mouseout":return function(b){try{a.call(b,m)}catch(c){}finally{f.ident=f.shape=null,f.click=f.again=!1}};case "contextmenu":return function(b){try{a.call(b,m)}catch(c){}finally{f.click=f.again=!1}}}}(v[b]={})},!0):v[b]={}}}(function(a){f.ident&&f.shape&&c.Array.each((a||v.mouseout)[f.ident],
function(a){a.call(f.shape,this,f.shape)},this)}))}catch(a){e=!1}return e};this.renew=function(){var a=[];try{c.Array.each(t,function(b){c.Array.each(b.shapes,function(b){return c.Array.push(a,b)&&!1})})}catch(b){}finally{for(;a.length;)c.Array.pop(a).paint()}};this.clear=function(){var a=[];try{c.Array.each(t,function(b){c.Array.each(b.shapes,function(d,e){delete b.shapes[e]&&c.Array.push(a,d)})})}catch(b){}finally{for(;a.length;)c.Array.pop(a).erase()}};this.build={LINE:g(function(a,d){this.route=
d.route;this.thick=d.thick;this.color=d.color;this.arrow=d.arrow;this.style=d.style;this.paint=function(d){if((a||0).alive&&a.ident&&a.cav2d&&a.mir2d)if(c.Match.isDefined(d)){if(!0===d&&3<(d=(this.route||0).length)&&u.call(this)&&!this.matte){a.cav2d.save();a.mir2d.save();a.cav2d.beginPath();a.mir2d.beginPath();a.cav2d.translate(l,b);a.mir2d.translate(l,b);a.cav2d.moveTo(this.route[0],this.route[1]);a.mir2d.moveTo(this.route[0],this.route[1]);for(var e=2;e<d;e+=2)n.styleTo.line.call(a.cav2d,this.style,
this.route[e-2],this.route[e-1],this.route[e],this.route[e+1],this.thick),n.styleTo.line.call(a.mir2d,this.style,this.route[e-2],this.route[e-1],this.route[e],this.route[e+1],this.thick);a.cav2d.save();a.mir2d.save();a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick;a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100;a.cav2d.strokeStyle=this.color;a.mir2d.strokeStyle=a.ident;a.cav2d.stroke();a.mir2d.stroke();a.cav2d.restore();a.mir2d.restore();this.arrow&&(d=c.Array.slice(this.route,
-4))&&(n.arrowTo.call(a.cav2d,d[2],d[3],Math.atan2(d[3]-d[1],d[2]-d[0]),this.thick),n.arrowTo.call(a.mir2d,d[2],d[3],Math.atan2(d[3]-d[1],d[2]-d[0]),this.thick),a.cav2d.save(),a.mir2d.save(),a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick,a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,a.cav2d.strokeStyle=this.color,a.cav2d.fillStyle=this.color,a.mir2d.strokeStyle=a.ident,a.mir2d.fillStyle=a.ident,a.cav2d.stroke(),a.mir2d.stroke(),a.cav2d.fill(),a.mir2d.fill(),a.cav2d.restore(),
a.mir2d.restore());a.cav2d.restore();a.mir2d.restore()}}else c.Array.each(a.cav2d.clearRect(0,0,a.scene.canvas.width,a.scene.canvas.height)||a.mir2d.clearRect(0,0,a.scene.mirror.width,a.scene.mirror.height)||a.scene.shapes,function(a){a.paint(!0)})}}),RECT:g(function(a,d){this.point=d.point;this.extra=d.extra;this.thick=d.thick;this.color=d.color;this.stuff=d.stuff;this.slope=d.slope;this.style=d.style;this.paint=function(d){if((a||0).alive&&a.ident&&a.cav2d&&a.mir2d)if(c.Match.isDefined(d)){if(!0===
d&&u.call(this)&&!this.matte&&this.point&&this.extra){d=[-this.slope*Math.PI/180,-this.extra.x,-this.extra.y,-this.extra.x,this.extra.y,this.extra.x,this.extra.y,this.extra.x,-this.extra.y,-this.extra.x,-this.extra.y];try{a.cav2d.save();a.mir2d.save();a.cav2d.beginPath();a.mir2d.beginPath();a.cav2d.translate(this.point.x+l,this.point.y+b);a.mir2d.translate(this.point.x+l,this.point.y+b);a.cav2d.rotate(d[0]);a.mir2d.rotate(d[0]);a.cav2d.moveTo(d[1],d[2]);a.mir2d.moveTo(d[1],d[2]);for(var e=3;11>e;e+=
2)n.styleTo.line.call(a.cav2d,this.style,d[e-2],d[e-1],d[e],d[e+1],this.thick),n.styleTo.line.call(a.mir2d,this.style,d[e-2],d[e-1],d[e],d[e+1],this.thick);a.cav2d.restore();a.mir2d.restore();a.cav2d.save();a.mir2d.save();a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick;a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100;a.cav2d.strokeStyle=this.color;a.mir2d.strokeStyle=a.ident;a.cav2d.stroke();a.mir2d.stroke();a.cav2d.restore();a.mir2d.restore();if(this.stuff){if(!z.test(this.style)){a.cav2d.save();
a.mir2d.save();a.cav2d.beginPath();a.mir2d.beginPath();a.cav2d.translate(this.point.x+l,this.point.y+b);a.mir2d.translate(this.point.x+l,this.point.y+b);a.cav2d.rotate(d[0]);a.mir2d.rotate(d[0]);a.cav2d.moveTo(d[1],d[2]);a.mir2d.moveTo(d[1],d[2]);for(e=3;11>e;e+=2)a.cav2d.lineTo(d[e],d[e+1]),a.mir2d.lineTo(d[e],d[e+1]);a.cav2d.restore();a.mir2d.restore()}a.cav2d.save();a.mir2d.save();a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100;a.cav2d.fillStyle=this.stuff;a.mir2d.fillStyle=
a.ident;a.cav2d.fill();a.mir2d.fill();a.cav2d.restore();a.mir2d.restore()}}catch(h){}finally{c.Array.clear(d)}}}else c.Array.each(a.cav2d.clearRect(0,0,a.scene.canvas.width,a.scene.canvas.height)||a.mir2d.clearRect(0,0,a.scene.mirror.width,a.scene.mirror.height)||a.scene.shapes,function(a){a.paint(!0)})}}),POLY:g(function(a,d){this.route=d.route;this.thick=d.thick;this.color=d.color;this.stuff=d.stuff;this.style=d.style;this.paint=function(d){if((a||0).alive&&a.ident&&a.cav2d&&a.mir2d)if(c.Match.isDefined(d)){if(!0===
d&&3<(d=(this.route||0).length)&&u.call(this)&&!this.matte){a.cav2d.save();a.mir2d.save();a.cav2d.beginPath();a.mir2d.beginPath();a.cav2d.translate(l,b);a.mir2d.translate(l,b);a.cav2d.moveTo(this.route[0],this.route[1]);a.mir2d.moveTo(this.route[0],this.route[1]);for(var e=0;e<d;e+=2)n.styleTo.line.call(a.cav2d,this.style,this.route[e],this.route[e+1],this.route[e+2]||this.route[0],this.route[e+3]||this.route[1],this.thick),n.styleTo.line.call(a.mir2d,this.style,this.route[e],this.route[e+1],this.route[e+
2]||this.route[0],this.route[e+3]||this.route[1],this.thick);a.cav2d.restore();a.mir2d.restore();a.cav2d.save();a.mir2d.save();a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick;a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100;a.cav2d.strokeStyle=this.color;a.mir2d.strokeStyle=a.ident;a.cav2d.stroke();a.mir2d.stroke();a.cav2d.restore();a.mir2d.restore();if(this.stuff){if(!z.test(this.style)){a.cav2d.save();a.mir2d.save();a.cav2d.beginPath();a.mir2d.beginPath();a.cav2d.translate(l,
b);a.mir2d.translate(l,b);a.cav2d.moveTo(this.route[0],this.route[1]);a.mir2d.moveTo(this.route[0],this.route[1]);for(e=2;e<d;e+=2)a.cav2d.lineTo(this.route[e],this.route[e+1]),a.mir2d.lineTo(this.route[e],this.route[e+1]);a.cav2d.closePath();a.mir2d.closePath();a.cav2d.restore();a.mir2d.restore()}a.cav2d.save();a.mir2d.save();a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100;a.cav2d.fillStyle=this.stuff;a.mir2d.fillStyle=a.ident;a.cav2d.fill();a.mir2d.fill();a.cav2d.restore();
a.mir2d.restore()}}}else c.Array.each(a.cav2d.clearRect(0,0,a.scene.canvas.width,a.scene.canvas.height)||a.mir2d.clearRect(0,0,a.scene.mirror.width,a.scene.mirror.height)||a.scene.shapes,function(a){a.paint(!0)})}}),OVAL:g(function(a,d){this.point=d.point;this.extra=d.extra;this.thick=d.thick;this.color=d.color;this.stuff=d.stuff;this.slope=d.slope;this.style=d.style;this.paint=function(d){if((a||0).alive&&a.ident&&a.cav2d&&a.mir2d)if(c.Match.isDefined(d)){if(!0===d&&u.call(this)&&!this.matte&&this.point&&
this.extra){d=[this.point.x+l,this.point.y+b,this.extra.x,this.extra.y,-this.slope*Math.PI/180];try{a.cav2d.save(),a.mir2d.save(),a.cav2d.beginPath(),a.mir2d.beginPath(),a.cav2d.translate(d[0],d[1]),a.mir2d.translate(d[0],d[1]),a.cav2d.rotate(d[4]),a.mir2d.rotate(d[4]),a.cav2d.scale(1,d[3]/d[2]),a.mir2d.scale(1,d[3]/d[2]),n.styleTo.oval.call(a.cav2d,this.style,0,0,d[2],d[3],this.thick),n.styleTo.oval.call(a.mir2d,this.style,0,0,d[2],d[3],this.thick),a.cav2d.restore(),a.mir2d.restore(),a.cav2d.save(),
a.mir2d.save(),a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick,a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,a.cav2d.strokeStyle=this.color,a.mir2d.strokeStyle=a.ident,a.cav2d.stroke(),a.mir2d.stroke(),a.cav2d.restore(),a.mir2d.restore(),this.stuff&&(z.test(this.style)||(a.cav2d.save(),a.mir2d.save(),a.cav2d.beginPath(),a.mir2d.beginPath(),a.cav2d.translate(d[0],d[1]),a.mir2d.translate(d[0],d[1]),a.cav2d.rotate(d[4]),a.mir2d.rotate(d[4]),a.cav2d.scale(1,d[3]/d[2]),
a.mir2d.scale(1,d[3]/d[2]),a.cav2d.arc(0,0,d[2],0,2*Math.PI,!0),a.mir2d.arc(0,0,d[2],0,2*Math.PI,!0),a.cav2d.restore(),a.mir2d.restore()),a.cav2d.save(),a.mir2d.save(),a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100,a.cav2d.fillStyle=this.stuff,a.mir2d.fillStyle=a.ident,a.cav2d.fill(),a.mir2d.fill(),a.cav2d.restore(),a.mir2d.restore())}catch(e){}finally{c.Array.clear(d)}}}else c.Array.each(a.cav2d.clearRect(0,0,a.scene.canvas.width,a.scene.canvas.height)||a.mir2d.clearRect(0,
0,a.scene.mirror.width,a.scene.mirror.height)||a.scene.shapes,function(a){a.paint(!0)})}}),ARCH:g(function(a,d){this.angle=d.angle;this.point=d.point;this.extra=d.extra;this.thick=d.thick;this.color=d.color;this.stuff=d.stuff;this.slope=d.slope;this.style=d.style;this.paint=function(d){if((a||0).alive&&a.ident&&a.cav2d&&a.mir2d)if(c.Match.isDefined(d)){if(!0===d&&u.call(this)&&!this.matte&&this.point&&this.extra&&this.angle){d=[this.point.x+l,this.point.y+b,this.extra.x,this.extra.y,-this.slope*Math.PI/
180,-q.ang2ecc(this.angle.f,this.extra.x,this.extra.y),-q.ang2ecc(this.angle.t,this.extra.x,this.extra.y)];try{a.cav2d.save(),a.mir2d.save(),a.cav2d.beginPath(),a.mir2d.beginPath(),a.cav2d.translate(d[0],d[1]),a.mir2d.translate(d[0],d[1]),a.cav2d.rotate(d[4]),a.mir2d.rotate(d[4]),a.cav2d.scale(1,d[3]/d[2]),a.mir2d.scale(1,d[3]/d[2]),n.styleTo.arch.call(a.cav2d,this.style,0,0,d[2],d[3],d[6],d[5],this.thick),n.styleTo.arch.call(a.mir2d,this.style,0,0,d[2],d[3],d[6],d[5],this.thick),a.cav2d.restore(),
a.mir2d.restore(),a.cav2d.save(),a.mir2d.save(),a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick,a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,a.cav2d.strokeStyle=this.color,a.mir2d.strokeStyle=a.ident,a.cav2d.stroke(),a.mir2d.stroke(),a.cav2d.restore(),a.mir2d.restore(),this.stuff&&(z.test(this.style)||(a.cav2d.save(),a.mir2d.save(),a.cav2d.beginPath(),a.mir2d.beginPath(),a.cav2d.translate(d[0],d[1]),a.mir2d.translate(d[0],d[1]),a.cav2d.rotate(d[4]),a.mir2d.rotate(d[4]),
a.cav2d.scale(1,d[3]/d[2]),a.mir2d.scale(1,d[3]/d[2]),a.cav2d.arc(0,0,d[2],d[5],d[6],!0),a.mir2d.arc(0,0,d[2],d[5],d[6],!0),a.cav2d.lineTo(0,0),a.mir2d.lineTo(0,0),a.cav2d.closePath(),a.mir2d.closePath(),a.cav2d.restore(),a.mir2d.restore()),a.cav2d.save(),a.mir2d.save(),a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100,a.cav2d.fillStyle=this.stuff,a.mir2d.fillStyle=a.ident,a.cav2d.fill(),a.mir2d.fill(),a.cav2d.restore(),a.mir2d.restore())}catch(e){}finally{c.Array.clear(d)}}}else c.Array.each(a.cav2d.clearRect(0,
0,a.scene.canvas.width,a.scene.canvas.height)||a.mir2d.clearRect(0,0,a.scene.mirror.width,a.scene.mirror.height)||a.scene.shapes,function(a){a.paint(!0)})}}),WAVE:g(function(a,d){this.route=d.route;this.thick=d.thick;this.color=d.color;this.arrow=d.arrow;this.style=d.style;this.paint=function(d){(a||0).alive&&a.ident&&a.cav2d&&a.mir2d&&(c.Match.isDefined(d)?!0===d&&5<(d=(this.route||0).length)&&u.call(this)&&!this.matte&&(a.cav2d.save(),a.mir2d.save(),a.cav2d.beginPath(),a.mir2d.beginPath(),a.cav2d.translate(l,
b),a.mir2d.translate(l,b),a.cav2d.moveTo(this.route[0],this.route[1]),a.mir2d.moveTo(this.route[0],this.route[1]),n.styleTo.wave.call(a.cav2d,this.style,this.route,this.thick),n.styleTo.wave.call(a.mir2d,this.style,this.route,this.thick),a.cav2d.save(),a.mir2d.save(),a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick,a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,a.cav2d.strokeStyle=this.color,a.mir2d.strokeStyle=a.ident,a.cav2d.stroke(),a.mir2d.stroke(),a.cav2d.restore(),
a.mir2d.restore(),this.arrow&&(d=c.Array.slice(this.route,-4))&&(n.arrowTo.call(a.cav2d,d[2],d[3],Math.atan2(d[3]-d[1],d[2]-d[0]),this.thick),n.arrowTo.call(a.mir2d,d[2],d[3],Math.atan2(d[3]-d[1],d[2]-d[0]),this.thick),a.cav2d.save(),a.mir2d.save(),a.mir2d.lineWidth=a.cav2d.lineWidth=this.thick,a.cav2d.globalAlpha=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,a.cav2d.strokeStyle=this.color,a.cav2d.fillStyle=this.color,a.mir2d.strokeStyle=a.ident,a.mir2d.fillStyle=a.ident,a.cav2d.stroke(),
a.mir2d.stroke(),a.cav2d.fill(),a.mir2d.fill(),a.cav2d.restore(),a.mir2d.restore()),a.cav2d.restore(),a.mir2d.restore()):c.Array.each(a.cav2d.clearRect(0,0,a.scene.canvas.width,a.scene.canvas.height)||a.mir2d.clearRect(0,0,a.scene.mirror.width,a.scene.mirror.height)||a.scene.shapes,function(a){a.paint(!0)}))}})}}:c.Support.graphic.vml?function(k,g){k.prototype={A:function(d){for(var e=0,g=d.length;e<g;e+=6)c.Array.push(this.save,"AE",Math.round(d[e]),Math.round(d[e+1]),Math.round(d[e+2]),Math.round(d[e+
3]),Math.round(d[e+4]),Math.round(d[e+5]));return this},C:function(d){for(var e=0,g=d.length;e<g;e+=6)c.Array.push(this.save,"C",Math.round(d[e]),Math.round(d[e+1]),Math.round(d[e+2]),Math.round(d[e+3]),Math.round(d[e+4]),Math.round(d[e+5]));return this},Q:function(d){for(var e=2,g=d.length;e<g;e+=4)c.Array.push(this.save,"C",Math.round(d[e-2]/3+2*d[e]/3),Math.round(d[e-1]/3+2*d[e+1]/3),Math.round(d[e+2]/3+2*d[e]/3),Math.round(d[e+3]/3+2*d[e+1]/3),Math.round(d[e+2]),Math.round(d[e+3]));return this},
L:function(d){for(var e=0,g=d.length;e<g;e+=2)c.Array.push(this.save,"L",Math.round(d[e]),Math.round(d[e+1]));return this},M:function(d){for(var e=0,g=d.length;e<g;e+=2)c.Array.push(this.save,"M",Math.round(d[e]),Math.round(d[e+1]));return this},Z:function(d){return c.Array.push(this.save,"XE")&&this},P:function(){return c.Array.join(this.save," ")}};return function(d,e,r,t){var v=0,f,l=function(b){return function(e){return function(g){b.apply(this,arguments);e.apply(this,arguments);c.Thread.delay.call(d,
function(){try{(f.shapes[g.ident=B.call(v++,"_")]=this).paint()}catch(b){g.error=b}finally{g.error||(this.regist("mouseout",function(){c.Util.setMouse(r,r.title="")}),this.regist("mouseover",c.Util.bind(this,function(){r.title=this.title||"";c.Util.setMouse(r,this.mouse)})))}},0,this)}}}(function(b,e){this.title=e.title;this.alpha=e.alpha;this.matte=e.matte;this.mouse=e.mouse;this.front=function(){(b||0).alive&&(!b.vml2d||b.run2d?c.Thread.delay.call(d,arguments.callee):f.appendChild(b.vml2d))};this.erase=
function(){!b.vml2d||b.run2d?c.Thread.delay.call(d,arguments.callee,0,this):(b||0).alive&&f.removeChild(b.vml2d)&&(delete f.shapes[b.ident]?(e=c.Array.each(b,function(d,c){delete b[c]}),b=c.Array.each(this,function(b,c){delete this[c]},this)):f.appendChild(b.vml2d))};this.regist=function(e,f){c.Match.isFunction(f)&&-1<c.Array.index(w,e=c.Parse.toTxt(e))&&function(){(b||0).alive&&(!b.vml2d||b.run2d?c.Thread.delay.call(d,arguments.callee,0,this):(f[b.ident]||(f[b.ident]={}))[e]=c.Util.addEvent({evt:e,
arg:this,obj:b.vml2d,fun:function(a){f.call(this,a,this)}},!0))}.call(this)};this.reject=function(e,f){c.Match.isFunction(f)&&-1<c.Array.index(w,e=c.Parse.toTxt(e))&&function(){(b||0).alive&&(!b.vml2d||b.run2d?c.Thread.delay.call(d,arguments.callee,0,this):c.Thread.delay.call(d,function(a){((a=f[b.ident])||0)[e]&&c.Util.delEvent(a[e])&&delete a[e]}))}.call(this)}});this.refix=function(b){(f||0).shapes&&(b=b||c.Util.getElemSize(r))&&(c.Parse.toInt(b.w),c.Parse.toInt(b.h))};this.slice=function(b){(f||
0).style&&c.Util.setElemSeat(f,{t:c.Parse.toInt(b.y)||0,l:c.Parse.toInt(b.x)||0})};this.ready=function(){if(!t&&e.namespaces.add("v","urn:schemas-microsoft-com:vml")){var b=e.createStyleSheet();try{t=((f=r.appendChild(document.createElement('<v:group style="position:absolute;top:0;left:0;width:1px;height:1px;" coordsize="1,1" coordorigin="0 0"><v:/group>'))).shapes={},!c.Array.each("v\\:fill v\\:skew v\\:shape v\\:image v\\:group v\\:stroke v\\:textbox".split(" "),function(c){b.addRule(c,"position:absolute;behavior:url(#default#VML);display:inline-block;")}))}catch(d){t=
!1}finally{b=null}}return t};this.renew=function(){(f||0).shapes&&c.Array.each(f.shapes,function(b){b.paint()})};this.clear=function(){(f||0).shapes&&c.Array.each(f.shapes,function(b){b.erase()})};this.build={LINE:l(function(b,e){this.route=e.route;this.thick=e.thick;this.color=e.color;this.arrow=e.arrow;this.style=e.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var e=3<(this.route||0).length?(new k).M(c.Array.slice(this.route,
0,2)).L(c.Array.slice(this.route,2)).P():"M 0 0";b.vml2d&&!(b.vml2d.style.display=this.matte?"none":"")?(b.vml2d.path=e,b.vml2d.write.color=this.color,b.vml2d.write.weight=this.thick,b.vml2d.write.dashstyle=this.style,b.vml2d.write.opacity=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,b.vml2d.write.endarrow=this.arrow?"classic":"none"):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.line,[e,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,this.style,
this.arrow?"classic":"none",this.matte?"none":""])],function(){if(b.run2d=!1,b.vml2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))b.vml2d.write=c.Dom.getFore(b.vml2d)})}}}),RECT:l(function(b,e){this.point=e.point;this.extra=e.extra;this.thick=e.thick;this.color=e.color;this.stuff=e.stuff;this.slope=e.slope;this.style=e.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var e=this.point&&this.extra?(new k).M([this.point.x-
this.extra.x,this.point.y-this.extra.y]).L([this.point.x-this.extra.x,this.point.y+this.extra.y,this.point.x+this.extra.x,this.point.y+this.extra.y,this.point.x+this.extra.x,this.point.y-this.extra.y,this.point.x-this.extra.x,this.point.y-this.extra.y]).P():"M 0 0",h=!this.matte&&this.slope&&"M 0 0"!==e?(new q.trans2d).rotate(-this.slope*Math.PI/180,this.point.x,this.point.y):!1;b.vml2d&&!(b.vml2d.style.display=this.matte?"none":"")?(b.vml2d.path=e,b.vml2d.stuff.color=(b.vml2d.stuff.on=!!this.stuff)?
this.stuff:"",b.vml2d.write.color=this.color,b.vml2d.write.weight=this.thick,b.vml2d.write.dashstyle=this.style,c.Match.isNum(this.alpha)?(b.vml2d.write.opacity=this.alpha,b.vml2d.stuff.opacity=this.alpha):(b.vml2d.write.opacity=this.alpha.ctur,b.vml2d.stuff.opacity=this.alpha.fill),(b.vml2d.slope.on=!!h)?(b.vml2d.slope.offset=h.offset(!0),b.vml2d.slope.matrix=h.matrix(!0)):(b.vml2d.slope.removeAttribute("offset"),b.vml2d.slope.removeAttribute("matrix"))):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.rect,
[e,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,this.style,!!this.stuff,this.stuff||"",this.matte?"none":"",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){(b.vml2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&(b.vml2d.write=c.Dom.getPrev(b.vml2d.stuff=c.Dom.getLast(b.vml2d)))&&c.Fx.draw.call(d,b.vml2d,[g.skew],function(){(b.run2d=!1,b.vml2d.slope=c.Dom.getLast(b.vml2d))&&(b.vml2d.slope.on=!!h)&&(b.vml2d.slope.offset=h.offset(!0),
b.vml2d.slope.matrix=h.matrix(!0))})})}}}),POLY:l(function(b,e){this.route=e.route;this.thick=e.thick;this.color=e.color;this.stuff=e.stuff;this.style=e.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var e=3<(this.route||0).length?(new k).M(c.Array.slice(this.route,0,2)).L(c.Array.slice(this.route,2)).Z().P():"M 0 0";b.vml2d&&!(b.vml2d.style.display=this.matte?"none":"")?(b.vml2d.path=e,b.vml2d.stuff.color=
(b.vml2d.stuff.on=!!this.stuff)?this.stuff:"",b.vml2d.write.color=this.color,b.vml2d.write.weight=this.thick,b.vml2d.write.dashstyle=this.style,c.Match.isNum(this.alpha)?(b.vml2d.write.opacity=this.alpha,b.vml2d.stuff.opacity=this.alpha):(b.vml2d.write.opacity=this.alpha.ctur,b.vml2d.stuff.opacity=this.alpha.fill)):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.poly,[e,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,this.style,!!this.stuff,this.stuff||"",this.matte?
"none":"",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){if(b.run2d=!1,b.vml2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))b.vml2d.write=c.Dom.getPrev(b.vml2d.stuff=c.Dom.getLast(b.vml2d))})}}}),OVAL:l(function(b,e){this.point=e.point;this.extra=e.extra;this.thick=e.thick;this.color=e.color;this.stuff=e.stuff;this.slope=e.slope;this.style=e.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var e=
this.point&&this.extra?(new k).A([this.point.x,this.point.y,this.extra.x,this.extra.y,0,23592960]).Z().P():"M 0 0",h=!this.matte&&this.slope&&"M 0 0"!==e?(new q.trans2d).rotate(-this.slope*Math.PI/180,this.point.x,this.point.y):!1;b.vml2d&&!(b.vml2d.style.display=this.matte?"none":"")?(b.vml2d.path=e,b.vml2d.stuff.color=(b.vml2d.stuff.on=!!this.stuff)?this.stuff:"",b.vml2d.write.color=this.color,b.vml2d.write.weight=this.thick,b.vml2d.write.dashstyle=this.style,c.Match.isNum(this.alpha)?(b.vml2d.write.opacity=
this.alpha,b.vml2d.stuff.opacity=this.alpha):(b.vml2d.write.opacity=this.alpha.ctur,b.vml2d.stuff.opacity=this.alpha.fill),(b.vml2d.slope.on=!!h)?(b.vml2d.slope.offset=h.offset(!0),b.vml2d.slope.matrix=h.matrix(!0)):(b.vml2d.slope.removeAttribute("offset"),b.vml2d.slope.removeAttribute("matrix"))):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.oval,[e,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,this.style,!!this.stuff,this.stuff||"",this.matte?"none":"",
(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){(b.vml2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))&&(b.vml2d.write=c.Dom.getPrev(b.vml2d.stuff=c.Dom.getLast(b.vml2d)))&&c.Fx.draw.call(d,b.vml2d,[g.skew],function(){(b.run2d=!1,b.vml2d.slope=c.Dom.getLast(b.vml2d))&&(b.vml2d.slope.on=!!h)&&(b.vml2d.slope.offset=h.offset(!0),b.vml2d.slope.matrix=h.matrix(!0))})})}}}),ARCH:l(function(b,e){this.angle=e.angle;this.point=e.point;this.extra=e.extra;this.thick=e.thick;this.color=
e.color;this.stuff=e.stuff;this.slope=e.slope;this.style=e.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!b.ident)c.Thread.delay.call(d,arguments.callee,0,this);else if(u.call(this)){var e=this.point&&this.extra&&this.angle?(new k).A([this.point.x,this.point.y,this.extra.x,this.extra.y,11796480*q.ang2ecc(this.angle.f,this.extra.x,this.extra.y)/Math.PI,11796480*(q.ang2ecc(this.angle.t,this.extra.x,this.extra.y)-q.ang2ecc(this.angle.f,this.extra.x,this.extra.y))/Math.PI]).L([this.point.x,
this.point.y]).Z().P():"M 0 0",h=!this.matte&&this.slope&&"M 0 0"!==e?(new q.trans2d).rotate(-this.slope*Math.PI/180,this.point.x,this.point.y):!1;b.vml2d&&!(b.vml2d.style.display=this.matte?"none":"")?(b.vml2d.path=e,b.vml2d.stuff.color=(b.vml2d.stuff.on=!!this.stuff)?this.stuff:"",b.vml2d.write.color=this.color,b.vml2d.write.weight=this.thick,b.vml2d.write.dashstyle=this.style,c.Match.isNum(this.alpha)?(b.vml2d.write.opacity=this.alpha,b.vml2d.stuff.opacity=this.alpha):(b.vml2d.write.opacity=this.alpha.ctur,
b.vml2d.stuff.opacity=this.alpha.fill),(b.vml2d.slope.on=!!h)?(b.vml2d.slope.offset=h.offset(!0),b.vml2d.slope.matrix=h.matrix(!0)):(b.vml2d.slope.removeAttribute("offset"),b.vml2d.slope.removeAttribute("matrix"))):b.run2d=!c.Fx.draw.call(d,f,[c.Util.format(g.arch,[e,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,this.style,!!this.stuff,this.stuff||"",this.matte?"none":"",(c.Match.isNum(this.alpha)?this.alpha:this.alpha.fill)/100])],function(){(b.vml2d=c.Array.pop(c.Fn.css.call(f,
"."+b.ident)))&&(b.vml2d.write=c.Dom.getPrev(b.vml2d.stuff=c.Dom.getLast(b.vml2d)))&&c.Fx.draw.call(d,b.vml2d,[g.skew],function(){(b.run2d=!1,b.vml2d.slope=c.Dom.getLast(b.vml2d))&&(b.vml2d.slope.on=!!h)&&(b.vml2d.slope.offset=h.offset(!0),b.vml2d.slope.matrix=h.matrix(!0))})})}}}),WAVE:l(function(b,e){this.route=e.route;this.thick=e.thick;this.color=e.color;this.arrow=e.arrow;this.style=e.style;this.paint=function(){if((b||0).alive)if(b.run2d||!f||!b.ident)c.Thread.delay.call(d,arguments.callee,
0,this);else if(u.call(this)){var e=5<(this.route||0).length?(new k).M(c.Array.slice(this.route,0,2))[8===this.route.length?"C":"Q"](c.Array.slice(this.route,2)).P():"M 0 0";b.vml2d&&!(b.vml2d.style.display=this.matte?"none":"")?(b.vml2d.path=e,b.vml2d.write.color=this.color,b.vml2d.write.weight=this.thick,b.vml2d.write.dashstyle=this.style,b.vml2d.write.opacity=(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,b.vml2d.write.endarrow=this.arrow?"classic":"none"):b.run2d=!c.Fx.draw.call(d,
f,[c.Util.format(g.wave,[e,b.ident,this.color,this.thick,(c.Match.isNum(this.alpha)?this.alpha:this.alpha.ctur)/100,this.style,this.arrow?"classic":"none",this.matte?"none":""])],function(){if(b.run2d=!1,b.vml2d=c.Array.pop(c.Fn.css.call(f,"."+b.ident)))b.vml2d.write=c.Dom.getFore(b.vml2d)})}}})}}}(function(){this.save=[]},{line:'<v:shape coordsize="1,1" style="width:1px;height:1px;display:$8;" path="$1" class="$2"><v:stroke color="$3" weight="$4" opacity="$5" dashstyle="$6" endarrow="$7"></v:stroke><v:fill on="f"></v:fill></v:shape>',
rect:'<v:shape coordsize="1,1" style="width:1px;height:1px;display:$9;" path="$1" class="$2"><v:stroke color="$3" weight="$4" opacity="$5" dashstyle="$6" endarrow="none"></v:stroke><v:fill on="$7" color="$8" opacity="$10"></v:fill></v:shape>',poly:'<v:shape coordsize="1,1" style="width:1px;height:1px;display:$9;" path="$1" class="$2"><v:stroke color="$3" weight="$4" opacity="$5" dashstyle="$6" endarrow="none"></v:stroke><v:fill on="$7" color="$8" opacity="$10"></v:fill></v:shape>',oval:'<v:shape coordsize="1,1" style="width:1px;height:1px;display:$9;" path="$1" class="$2"><v:stroke color="$3" weight="$4" opacity="$5" dashstyle="$6" endarrow="none"></v:stroke><v:fill on="$7" color="$8" opacity="$10"></v:fill></v:shape>',
arch:'<v:shape coordsize="1,1" style="width:1px;height:1px;display:$9;" path="$1" class="$2"><v:stroke color="$3" weight="$4" opacity="$5" dashstyle="$6" endarrow="none"></v:stroke><v:fill on="$7" color="$8" opacity="$10"></v:fill></v:shape>',wave:'<v:shape coordsize="1,1" style="width:1px;height:1px;display:$8;" path="$1" class="$2"><v:stroke color="$3" weight="$4" opacity="$5" dashstyle="$6" endarrow="$7"></v:stroke><v:fill on="f"></v:fill></v:shape>',skew:'<v:skew on="f"></v:skew>'}):null;c.Graphic=
function(k,g){if(D&&k){var d=new D(c.Util.getWin(g),c.Util.getDoc(g),c.Match.isString(k)?c.Fn.id(k):k,!1);if((d||0).ready())this.renewStage=function(){d.renew()},this.clearStage=function(){d.clear()},this.refixStage=function(c){d.refix(c)},this.sliceStage=function(c){d.slice(c)},this.createLine=function(c){return new d.build.LINE({alive:!0},c)},this.createRect=function(c){return new d.build.RECT({alive:!0},c)},this.createPoly=function(c){return new d.build.POLY({alive:!0},c)},this.createOval=function(c){return new d.build.OVAL({alive:!0},
c)},this.createArch=function(c){return new d.build.ARCH({alive:!0},c)},this.createWave=function(c){return new d.build.WAVE({alive:!0},c)};else throw"Prepare Exception";}else throw"Support Exception";}})(jMagic);
